# Feature Development Rules

## Adding a New Feature

1. **Create feature directory**: `src/features/<feature-name>/`
2. **Set up structure**:
   - `domain/` - Schemas, types, business logic
   - `data/` - Server actions, tRPC procedures
   - `ui/` - React components
   - `index.ts` - Public API exports
3. **Write tests** alongside implementation
4. **Update documentation** if needed
5. **Follow feature module pattern** strictly

## Feature Module Pattern

### Domain Layer (`domain/`)
- Zod schemas for validation
- TypeScript types and interfaces
- Pure business logic functions
- No side effects

### Data Layer (`data/`)
- Server actions (`"use server"`)
- tRPC procedures
- API route handlers
- Database queries
- External API calls

### UI Layer (`ui/`)
- React components
- Client components (`"use client"` when needed)
- Form components
- Presentational components

### Public API (`index.ts`)
- Export only what other features need
- Hide implementation details
- Provide clear, typed interfaces

## Cross-Feature Communication

- **No direct imports** between features
- Use public APIs via `index.ts`
- Prefer composition over coupling
- Use shared utilities in `src/lib/` for common needs

## Example Structure

```
src/features/auth/
├── domain/
│   ├── loginSchema.ts
│   └── types.ts
├── data/
│   ├── loginAction.ts
│   └── authProcedures.ts
├── ui/
│   ├── LoginForm.tsx
│   └── LogoutButton.tsx
└── index.ts
```
