# Next.js App Router

Goal: Prevent path/layout disagreements between agents.

- Use route groups:
  - `/app/(marketing)` for public
  - `/app/(app)` for authed
- Server Components by default
- Client components require `"use client"` and reason
- Data fetching in server layer first; client fetch only when necessary
- Default runtime: `nodejs` (Edge requires ADR)
- Metadata in `layout.tsx` or `page.tsx`
- Route handlers in `/app/api/**/route.ts`
- Server Actions in `"use server"` files

## Related Rules

- **137-nextjs-server-client-separation.mdc** - Server/Client component separation patterns (prevents "createMotionComponent from server" errors)
- **136-document-viewer-patterns.mdc** - Document organization and rendering patterns
