# Core Architecture

Goal: Prevent architecture drift and keep code boring/evolutionary.

- App Router only. No Pages Router.
- Feature-module standard: `src/features/<feature>/{ui,data,domain}`
- Public API only: cross-feature imports must go through `src/features/<feature>/index.ts`
- Domain purity: `domain/` contains pure logic only (no React, no I/O)
- Validation at edges: Zod schemas in `domain/schemas.ts`, used by server actions/tRPC
- Route shells only: `/app/(app)/<feature>` imports UI from `src/features/*/ui`; no duplicate UI under `/app`
- Keep it boring: no new abstractions unless repeated â‰¥3 times
- **Enterprise-readiness primitives** (baked in, even if dormant):
  - `audit_log` table in schema
  - Export/delete flows scaffolded
  - RBAC scaffolding
  - Rate limiting infrastructure
  - Observability baseline (see `.cursor/rules/020-core-observability.mdc`)
- TypeScript strict mode always ON
- Never use `any` (explicit or implicit)
- Create type guards for parsing unknown data
- Use `noUncheckedIndexedAccess` for safer array/object access
- Prefer simple, maintainable solutions over clever abstractions
- Make small, verifiable changes
- Create ADR in `docs/adr/` when architecture changes are needed
